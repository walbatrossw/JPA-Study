# 실전예제 5. 연관관계 관리

## 1) 글로벌 페치 전략 설정

- 글로벌 페치 전략을 즉시로딩으로 설정하면 사용하지 않는 엔티티도 함께 조회되므로 모두 지연로딩으로 설정
- `@OneToMany`,`@ManyToMany`는 기본이 지연로딩이므로 그냥 둠
- `@OneToOne`, `@ManyToOne`의 fetch 속성을 지연로딩으로 수정
- 주문과 주문상품에 `@OneToOne`, `@ManyToOne`으로 매핑한 속성을 지연로딩으로 설정

## 2) 영속성 전이 설정
- 엔티티를 영속상태로 만들어서 데이터베이스에 저장할 때 연관된 엔티티 모두 영속상태이어야 함
- 연관된 엔티티 중 영속상태가 아닌 엔티티가 있으면 예외가 발생(플러시 시점에서 오류)
- 영속성 전이를 사용하면 연관된 엔티티를 편리하게 영속상태로 만들수 있음
- 주문과 배송, 주문과 주문상품의 연관관계에 영속성 전이를 사용
    1. Order(주문) ---> Delivery(배송) 관계인 `delivery`필드에 영속성 전이 `cascade = CascadeType.ALL` 설정
    2. Order(주문) ---> OrderItem(주문상품) 관계인 `orderItems`필드에 영속성 전이 `cascade = CascadeType.ALL` 설정
- Order만 영속상태로 만들면 영속성 전이를 설정한 Delivery, OrderItem도 영속상태가 됨(플러시 시점)
